<div class="fixed inset-0 flex justify-center items-center z-50">
  <!-- Fondo oscuro semitransparente -->
  <div class="absolute inset-0 bg-black/70" (click)="close.emit()"></div>

  <!-- Formulario principal del modal -->
  <form class="relative bg-white p-6 rounded w-150 shadow-xl z-10 p-12" (ngSubmit)="handleSubmit()">
    <!-- Botón X para cerrar modal -->
    <button
      type="button"
      class="absolute top-2 right-2 text-gray-500 hover:text-teal-700 font-bold text-lg mr-4 mt-2"
      (click)="close.emit()"
      aria-label="Cerrar"
    >
      ✕
    </button>

    <!-- Título del modal cambia según edición o creación -->
    <h2 class="italic text-2xl text-teal-700 font-semibold mb-16">
      {{ task ? 'Editar' : 'Nueva' }} Tarea
    </h2>

    <!-- Título obligatorio -->
    <label> Título <span class="text-red-600">*</span> </label>
    <input
      type="text"
      [(ngModel)]="form.title"
      name="title"
      required
      minlength="3"
      class="border border-teal-700 rounded p-2 w-full mb-6"
    />

    <!-- Descripción opcional -->
    <label>Descripción</label>
    <textarea
      [(ngModel)]="form.description"
      name="description"
      class="border border-teal-700 rounded p-2 w-full mb-2"
    ></textarea>

    <!-- Fecha de vencimiento opcional -->
    <label>Fecha Fin</label>
    <input
      type="date"
      [(ngModel)]="form.dueDate"
      name="dueDate"
      class="border border-teal-700 rounded p-2 w-full mb-6"
    />

    <!-- Estado de la tarea -->
    <label>Estado</label>
    <select
      [(ngModel)]="form.status"
      name="status"
      class="border border-teal-700 rounded p-2 w-full mb-6"
    >
      <option value="toDo">Pendiente</option>
      <option value="inProgress">En progreso</option>
      <option value="done">Completada</option>
    </select>

    <!-- Prioridad de la tarea -->
    <label>Prioridad</label>
    <select
      [(ngModel)]="form.priority"
      name="priority"
      class="border border-teal-700 rounded p-2 w-full mb-6"
    >
      <option value="low">Baja</option>
      <option value="medium">Media</option>
      <option value="high">Alta</option>
    </select>

    <!-- BOTONES: Cancelar y Guardar -->
    <div class="flex justify-end gap-2 mt-16">
      <!-- Cancelar cierra el modal -->
      <button
        type="button"
        class="w-28 py-1 bg-gray-300 text-gray-700 font-medium rounded hover:bg-gray-400 hover:text-white transition"
        (click)="close.emit()"
      >
        Cancelar
      </button>

      <!-- Guardar envía el formulario -->
      <button
        type="submit"
        [disabled]="saving || saved"
        class="w-28 h-10 bg-teal-600 hover:bg-teal-700 active:bg-teal-800 text-white font-semibold rounded shadow flex justify-center items-center transition-all duration-200"
      >
        <!-- Mostrar texto "Guardar" mientras no se ha guardado -->
        <span *ngIf="!saved">Guardar</span>

        <!-- Mostrar check si la tarea ya fue guardada -->
        <ng-container *ngIf="saved">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="white"
            stroke-width="3"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="w-6 h-6"
          >
            <polyline points="20 6 9 17 4 12" />
          </svg>
        </ng-container>
      </button>
    </div>
  </form>
</div>